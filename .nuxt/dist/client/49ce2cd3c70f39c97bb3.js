(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{332:function(t,e,o){"use strict";o.r(e);var n=o(421),c=o.n(n),r=o(54),l=o(378),v={props:{bookStatus:{type:String,default:"booking"}},data:function(){return{qrCode:null,codeErr:!1,phoneErr:!1,codeBtnText:"请输入验证码",countDown:61,startCount:!1,form:{country_num:"86",platforms:1,mobile:"",sms_captcha:"",inviter_id:""},invite_id_self:"",inviteLink:""}},mounted:function(){var t=this;"success"===this.bookStatus?(this.invite_id_self=l.a(),this.inviteLink=location.origin+"?invite_code="+this.invite_id_self,this.$nextTick((function(){t.crateQrcode()}))):this.form.inviter_id=this.$route.query.invite_code},methods:{toCopyLink:function(){document.getElementById("inviteLink").select(),document.execCommand("copy")},crateQrcode:function(){var t=o(423);this.qrCode=new t("qrcode",{width:150,height:150,text:this.inviteLink})},closePop:function(){this.$emit("closePop")},selectPlatform:function(t){this.form.platforms="ios"===t?1:2},checkPhone:function(){console.log(this.form.mobile),/^[0-9]{6,16}$/.test(this.form.mobile)?this.phoneErr=!1:this.phoneErr=!0},checkCode:function(){/^[0-9]{6}$/.test(this.form.sms_captcha)?this.codeErr=!1:this.codeErr=!0},getCode:function(){var t=this;if(this.checkPhone(),!this.phoneErr){var param={country_num:"86",mobile:this.form.mobile};Object(r.d)(c.a.stringify(param)).then((function(e){0===e.code?(t.startCount=!0,t.toCountDown()):t.phoneErr=!0}))}},toCountDown:function(){var t=this;this.countDown--,setTimeout((function(){t.countDown>1?t.toCountDown():(t.startCount=!1,t.countDown=61)}),1e3)},changeBookStatus:function(t){this.$emit("changeBookStatus",t)},changeAuth:function(){l.b(),this.$emit("changeBookStatus","booking")},submitForm:function(){var t=this;this.checkPhone(),this.checkCode(),this.phoneErr||this.codeErr||Object(r.j)(c.a.stringify(this.form)).then((function(e){0===e.code?(t.changeBookStatus("success"),t.invite_id_self=e.data.invite_id,t.inviteLink=location.origin+"?invite_code="+t.invite_id_self,t.$nextTick((function(){t.crateQrcode()})),l.c(t.invite_id_self)):t.codeErr=!0}))}}},d=(o(414),o(6)),component=Object(d.a)(v,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"pop",on:{wheel:function(t){t.preventDefault()}}},[o("div",{staticClass:"pop-box"},[o("i",{staticClass:"close-icon icon btn",on:{click:t.closePop}}),t._v(" "),"booking"==t.bookStatus?o("div",{staticClass:"pop-content"},[o("div",{staticClass:"form-box"},[o("div",{staticClass:"platform-select"},[o("div",{staticClass:"platform-item left btn",class:{selected:1==t.form.platforms},on:{click:function(e){return t.selectPlatform("ios")}}},[o("i",{staticClass:"ios-icon icon"})]),t._v(" "),o("div",{staticClass:"platform-item right btn",class:{selected:2==t.form.platforms},on:{click:function(e){return t.selectPlatform("android")}}},[o("i",{staticClass:"android-icon icon"})])]),t._v(" "),o("div",{staticClass:"phone-edit"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.form.mobile,expression:"form.mobile"}],attrs:{type:"text"},domProps:{value:t.form.mobile},on:{blur:t.checkPhone,input:function(e){e.target.composing||t.$set(t.form,"mobile",e.target.value)}}}),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:t.phoneErr,expression:"phoneErr"}],staticClass:"input-err"},[o("i",{staticClass:"err-icon icon"}),t._v("请输入正确的手机号码")])]),t._v(" "),o("div",{staticClass:"code-edit"},[o("div",{staticClass:"code-input"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.form.sms_captcha,expression:"form.sms_captcha"}],attrs:{type:"text",placeholder:"请输入验证码"},domProps:{value:t.form.sms_captcha},on:{blur:t.checkCode,input:function(e){e.target.composing||t.$set(t.form,"sms_captcha",e.target.value)}}})]),t._v(" "),t.startCount?o("div",{staticClass:"code-btn btn"},[t._v(t._s(t.countDown)+"s")]):o("div",{staticClass:"code-btn btn",on:{click:t.getCode}},[t._v("请输入验证码")]),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:t.codeErr,expression:"codeErr"}],staticClass:"input-err"},[o("i",{staticClass:"err-icon icon"}),t._v("请输入正确的短信验证码")])]),t._v(" "),o("div",{staticClass:"submit-btn btn",on:{click:t.submitForm}},[t._v("立即预约")])])]):o("div",{staticClass:"pop-content"},[o("div",{staticClass:"ribbon-animation"}),t._v(" "),o("div",{staticClass:"colorpaper-animation"}),t._v(" "),o("div",{staticClass:"book-success-box"},[o("div",{staticClass:"qr-box"},[o("div",{staticClass:"qr-sticker"}),t._v(" "),o("div",{ref:"qrcode",staticClass:"qr-pic",attrs:{id:"qrcode"}})]),t._v(" "),o("div",{staticClass:"invite-content"},[t._m(0),t._v(" "),o("div",{staticClass:"invite-link"},[o("p",{staticClass:"title"},[t._v("专属邀请链接：")]),t._v(" "),o("div",{staticClass:"link-box"},[o("div",{staticClass:"input-box"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.inviteLink,expression:"inviteLink"}],attrs:{id:"inviteLink",type:"text",readonly:""},domProps:{value:t.inviteLink},on:{input:function(e){e.target.composing||(t.inviteLink=e.target.value)}}})]),t._v(" "),o("div",{staticClass:"copy-btn btn",on:{click:t.toCopyLink}},[t._v("复制链接")])])])])]),t._v(" "),o("p",{staticClass:"change-account"},[o("span",{staticClass:"btn",on:{click:t.changeAuth}},[t._v("切换绑定手机")])])])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"invite-text"},[e("p",{staticClass:"title"},[this._v("恭喜您预约成功!")]),this._v(" "),e("p",{staticClass:"invite-des"},[this._v("截图保存二维码或复制邀请链接，发给小伙伴抱团一起来玩吧，抱团人数越多，奖励越大。")])])}],!1,null,"1c357b13",null);e.default=component.exports},374:function(t,e,o){},378:function(t,e,o){"use strict";o.d(e,"a",(function(){return c})),o.d(e,"c",(function(){return r})),o.d(e,"b",(function(){return l}));var n="guid";function c(){return localStorage.getItem(n)}function r(t){return localStorage.setItem(n,t)}function l(){return localStorage.removeItem(n)}},414:function(t,e,o){"use strict";var n=o(374);o.n(n).a}}]);